import{ap as L,aq as K,ar as H,as as z,a as k,r as l,j as e,g as D,aw as S,at as B}from"./index-e9055987.js";import{b as O}from"./SalesService-3d09fa59.js";import{A as $}from"./AdaptableCard-459786db.js";import{B as x}from"./Button-ba65fcd6.js";import{C as P,_ as V,a1 as q,a2 as G,a3 as U,a4 as _}from"./index.esm-1ac4f407.js";import{I as F}from"./Input-cff490ba.js";import{d as W}from"./debounce-85f84bbc.js";import{c as Q}from"./cloneDeep-860e24f8.js";import{F as J,a as y}from"./FormItem-ea0b05bc.js";import{C as h}from"./index-0b16cfb5.js";import{D as X}from"./Drawer-1d10f851.js";import{F as Y,a as ee,b as C}from"./formik.esm-026afa26.js";import{a as te}from"./ProductCreateService-a12bd612.js";import{T as j}from"./index-95867d9f.js";import{u as I,g as R,e as ae,f as g}from"./index-f0b8471c.js";import"./Card-433b6df5.js";import"./Views-51136580.js";import"./isNil-1a93575e.js";import"./get-c3140d19.js";import"./_MapCache-0feb66c1.js";import"./_Uint8Array-1ce16692.js";import"./_getPrototype-241bf201.js";import"./index-8f83c5d8.js";import"./motion-4061acbd.js";import"./_baseIsEqual-7de73e16.js";import"./index-1248b5e2.js";import"./warning-6ee4a779.js";import"./CloseButton-3f8e850c.js";const w="salesProductList",b=L(w+"/products",async t=>(await O(t)).data),N={total:0,pageIndex:1,pageSize:10,query:"",sort:{order:"",key:""}},se={loading:!1,deleteConfirmation:!1,selectedProduct:"",productList:[],tableData:N,filterData:{name:"",subcategory:[],status:["En Inventario","En Camino","Agotado"]}},E=K({name:`${w}/state`,initialState:se,reducers:{updateProductList:(t,a)=>{t.productList=a.payload},setTableData:(t,a)=>{t.tableData=a.payload},setFilterData:(t,a)=>{t.filterData=a.payload},toggleDeleteConfirmation:(t,a)=>{t.deleteConfirmation=a.payload},setSelectedProduct:(t,a)=>{t.selectedProduct=a.payload}},extraReducers:t=>{t.addCase(b.fulfilled,(a,c)=>{a.productList=c.payload.data,a.tableData.total=c.payload.total,a.loading=!1}).addCase(b.pending,a=>{a.loading=!0})}}),{updateProductList:Xe,setTableData:re,setFilterData:oe,toggleDeleteConfirmation:Ye,setSelectedProduct:et}=E.actions,ne=E.reducer,ce=H({data:ne}),M=z,ie=()=>{const t=k(),a=l.useRef(null),c=M(s=>s.salesProductList.data.tableData),n=W(r,500);function r(s){const d=Q(c);d.query=s,d.pageIndex=1,typeof s=="string"&&s.length>1&&o(d),typeof s=="string"&&s.length===0&&o(d)}const o=s=>{t(re(s)),t(b(s))},i=s=>{n(s.target.value)};return e.jsx(F,{ref:a,className:"max-w-md md:w-52 md:mb-0 mb-4",size:"sm",placeholder:"Search product",prefix:e.jsx(P,{className:"text-lg"}),onChange:i})},Z=l.forwardRef(({onSubmitComplete:t},a)=>{const c=k(),[n,r]=l.useState([]);l.useEffect(()=>{te().then(s=>r(s.data.subcategories)).catch()},[]);const o=M(s=>s.salesProductList.data.filterData),i=s=>{t==null||t(),c(oe(s)),c(b({...N,filterData:s}))};return e.jsx(Y,{enableReinitialize:!0,innerRef:a,initialValues:o,onSubmit:s=>i(s),children:({values:s,touched:d,errors:u})=>e.jsx(ee,{children:e.jsxs(J,{children:[e.jsxs(y,{invalid:u.name&&d.name,errorMessage:u.name,children:[e.jsx("h6",{className:"mb-4",children:"Included text"}),e.jsx(C,{type:"text",autoComplete:"off",name:"name",placeholder:"Keyword",component:F,prefix:e.jsx(P,{className:"text-lg"})})]}),e.jsxs(y,{invalid:u.subcategory&&d.subcategory,errorMessage:u.subcategory,children:[e.jsx("h6",{className:"mb-4",children:"Subcategoría de Producto"}),e.jsx(C,{name:"subcategory",children:({field:m,form:f})=>e.jsx(e.Fragment,{children:e.jsx(h.Group,{vertical:!0,value:s.subcategory,onChange:p=>f.setFieldValue(m.name,p),children:n.map(p=>e.jsxs(h,{className:"mb-3",name:m.name,value:p._id,children:[p.name," "]}))})})})]}),e.jsxs(y,{invalid:u.status&&d.status,errorMessage:u.status,children:[e.jsx("h6",{className:"mb-4",children:"Product Category"}),e.jsx(C,{name:"status",children:({field:m,form:f})=>e.jsx(e.Fragment,{children:e.jsxs(h.Group,{vertical:!0,value:s.status,onChange:p=>f.setFieldValue(m.name,p),children:[e.jsxs(h,{className:"mb-3",name:m.name,value:"En Inventario",children:["En Inventario"," "]}),e.jsxs(h,{className:"mb-3",name:m.name,value:"En Camino",children:["En Camino"," "]}),e.jsxs(h,{className:"mb-3",name:m.name,value:"Agotado",children:["Agotado"," "]})]})})})]})]})})})}),le=({onSaveClick:t,onCancel:a})=>e.jsxs("div",{className:"text-right w-full",children:[e.jsx(x,{size:"sm",className:"mr-2",onClick:a,children:"Cancel"}),e.jsx(x,{size:"sm",variant:"solid",onClick:t,children:"Query"})]}),de=()=>{const t=l.useRef(null),[a,c]=l.useState(!1),n=()=>{c(!0)},r=()=>{c(!1)},o=()=>{var i;(i=t.current)==null||i.submitForm()};return e.jsxs(e.Fragment,{children:[e.jsx(x,{size:"sm",className:"block md:inline-block ltr:md:ml-2 rtl:md:mr-2 md:mb-0 mb-4",icon:e.jsx(V,{}),onClick:()=>n(),children:"Filter"}),e.jsx(X,{title:"Filter",isOpen:a,footer:e.jsx(le,{onCancel:r,onSaveClick:o}),onClose:r,onRequestClose:r,children:e.jsx(Z,{ref:t,onSubmitComplete:r})})]})};Z.displayName="FilterForm";const me=()=>e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center",children:[e.jsx(ie,{}),e.jsx(de,{}),e.jsx(D,{download:!0,className:"block lg:inline-block md:mx-2 md:mb-0 mb-4",to:"/data/product-list.csv",target:"_blank",children:e.jsx(x,{block:!0,size:"sm",icon:e.jsx(q,{}),children:"Export"})}),e.jsx(D,{className:"block lg:inline-block md:mb-0 mb-4",to:"/app/sales/product-new",children:e.jsx(x,{block:!0,variant:"solid",size:"sm",icon:e.jsx(G,{}),children:"Add Product"})})]}),{Tr:T,Th:ue,Td:A,THead:pe,TBody:he}=j;function xe({data:t,renderRowSubComponent:a,getRowCanExpand:c}){const n=l.useMemo(()=>[{header:()=>null,id:"expander",cell:({row:o})=>e.jsx(e.Fragment,{children:o.getCanExpand()&&e.jsx("button",{className:"text-lg",onClick:o.getToggleExpandedHandler(),children:o.getIsExpanded()?e.jsx(U,{}):e.jsx(_,{})})})},{header:"ID",accessorKey:"id"},{header:"Nombre",accessorKey:"name"},{header:"Precio",accessorKey:"price"},{header:"Categoría",accessorKey:"category.name"},{header:"Tipo",accessorKey:"type"},{header:"Origen",accessorKey:"origin"},{header:"Estado",accessorKey:"state"}],[]),r=I({data:t,columns:n,getRowCanExpand:c,getCoreRowModel:R(),getExpandedRowModel:ae()});return e.jsxs(j,{children:[e.jsx(pe,{children:r.getHeaderGroups().map(o=>e.jsx(T,{children:o.headers.map(i=>e.jsx(ue,{colSpan:i.colSpan,children:g(i.column.columnDef.header,i.getContext())},i.id))},o.id))}),e.jsx(he,{children:r.getRowModel().rows.map(o=>e.jsxs(l.Fragment,{children:[e.jsx(T,{children:o.getVisibleCells().map(i=>e.jsx(A,{children:g(i.column.columnDef.cell,i.getContext())},i.id))}),o.getIsExpanded()&&e.jsx(T,{children:e.jsx(A,{colSpan:o.getVisibleCells().length,children:a({row:o})})})]},o.id))})]})}const{Tr:v,Th:ge,Td:be,THead:je,TBody:fe}=j;function ye({data:t}){const a=l.useMemo(()=>[{header:"ID",accessorKey:"id"},{header:"Nombre",accessorKey:"name"},{header:"Precio",accessorKey:"price"},{header:"Stock",accessorKey:"stock"},{header:"Moneda",accessorKey:"currency.name"}],[]),c=I({data:t,columns:a,getCoreRowModel:R()});return e.jsxs(j,{children:[e.jsx(je,{children:e.jsx(v,{children:c.getHeaderGroups().map(n=>e.jsx(l.Fragment,{children:n.headers.map(r=>e.jsx(ge,{colSpan:r.colSpan,children:g(r.column.columnDef.header,r.getContext())},r.id))},n.id))})}),e.jsx(fe,{children:c.getRowModel().rows.map(n=>e.jsx(v,{children:n.getVisibleCells().map(r=>e.jsx(be,{children:g(r.column.columnDef.cell,r.getContext())},r.id))},n.id))})]})}const Ce={getProducts:()=>Promise.resolve([{id:1,name:"Classic T-Shirt",description:"Comfortable cotton t-shirt",price:19.99,categoryId:1,createdAt:"2023-05-01T00:00:00Z",shopId:1,cost:10,discount:0,state:"available",ownerId:1,gender:"unisex",commission:5,type:"variable",origin:"manufactured",commissionType:"percentage",referenceCurrency:1,category:{id:1,name:"Apparel",description:"Clothing and accessories",createdAt:"2023-01-01T00:00:00Z",parentId:null},currency:{id:1,name:"USD",exchangeRate:1,isAutomatic:!0,createdAt:"2023-01-01T00:00:00Z"},variations:[{id:1,productId:1,name:"Small Black",price:19.99,stock:100,createdAt:"2023-05-01T00:00:00Z",thumbnail:"https://example.com/small-black-tshirt.jpg",pictures:["https://example.com/small-black-tshirt-1.jpg","https://example.com/small-black-tshirt-2.jpg"],currencyId:1,currency:{id:1,name:"USD",exchangeRate:1,isAutomatic:!0,createdAt:"2023-01-01T00:00:00Z"},attributes:[{id:1,type:1,value:"Small",createdAt:"2023-05-01T00:00:00Z",attribute:{id:1,name:"Size",createdAt:"2023-01-01T00:00:00Z"}},{id:2,type:2,value:"Black",createdAt:"2023-05-01T00:00:00Z",attribute:{id:2,name:"Color",createdAt:"2023-01-01T00:00:00Z"}}]},{id:2,productId:1,name:"Medium White",price:19.99,stock:150,createdAt:"2023-05-01T00:00:00Z",thumbnail:"https://example.com/medium-white-tshirt.jpg",pictures:["https://example.com/medium-white-tshirt-1.jpg","https://example.com/medium-white-tshirt-2.jpg"],currencyId:1,currency:{id:1,name:"USD",exchangeRate:1,isAutomatic:!0,createdAt:"2023-01-01T00:00:00Z"},attributes:[{id:3,type:1,value:"Medium",createdAt:"2023-05-01T00:00:00Z",attribute:{id:1,name:"Size",createdAt:"2023-01-01T00:00:00Z"}},{id:4,type:2,value:"White",createdAt:"2023-05-01T00:00:00Z",attribute:{id:2,name:"Color",createdAt:"2023-01-01T00:00:00Z"}}]}]},{id:2,name:"Leather Wallet",description:"Genuine leather wallet",price:49.99,categoryId:2,createdAt:"2023-05-02T00:00:00Z",shopId:1,cost:25,discount:10,state:"available",ownerId:1,gender:"unisex",commission:7.5,type:"simple",origin:"imported",commissionType:"fixed",referenceCurrency:1,category:{id:2,name:"Accessories",description:"Personal accessories",createdAt:"2023-01-01T00:00:00Z",parentId:null},currency:{id:1,name:"USD",exchangeRate:1,isAutomatic:!0,createdAt:"2023-01-01T00:00:00Z"},variations:[]}])},Te=()=>{const[t,a]=S.useState([]);S.useEffect(()=>{Ce.getProducts().then(a)},[]);const c=({row:n})=>{const r=n.original.variations||[];return e.jsx(ye,{data:r})};return e.jsx(xe,{data:t,renderRowSubComponent:c,getRowCanExpand:n=>n.original.variations&&n.original.variations.length>0})};B("salesProductList",ce);const De=()=>e.jsxs($,{className:"h-full",bodyClass:"h-full",children:[e.jsxs("div",{className:"lg:flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"mb-4 lg:mb-0",children:"Products"}),e.jsx(me,{})]}),e.jsx(Te,{})]}),tt=De;export{tt as default};
